import type { ClinicalCase } from '../types';

export const cases: ClinicalCase[] = [
  {
    id: 'hyponatremia-case',
    moduleId: 'electrolytes',
    title: 'Post-operative Hyponatremia',
    difficulty: 'intermediate',
    presentation:
      'A 68-year-old woman underwent total hip replacement 2 days ago. She now complains of nausea and headache. She appears confused and disoriented. Post-operative fluid management included D5W at 125 mL/hr.',
    labValues: [
      {
        id: 'na',
        name: 'Sodium',
        abbreviation: 'Na⁺',
        value: 118,
        unit: 'mEq/L',
        referenceRange: { min: 135, max: 145, criticalLow: 120, criticalHigh: 160 },
        category: 'Electrolytes',
      },
      {
        id: 'k',
        name: 'Potassium',
        abbreviation: 'K⁺',
        value: 3.8,
        unit: 'mEq/L',
        referenceRange: { min: 3.5, max: 5.0, criticalLow: 2.5, criticalHigh: 6.5 },
        category: 'Electrolytes',
      },
      {
        id: 'cl',
        name: 'Chloride',
        abbreviation: 'Cl⁻',
        value: 85,
        unit: 'mEq/L',
        referenceRange: { min: 96, max: 106 },
        category: 'Electrolytes',
      },
      {
        id: 'hco3',
        name: 'Bicarbonate',
        abbreviation: 'HCO₃⁻',
        value: 24,
        unit: 'mEq/L',
        referenceRange: { min: 22, max: 28 },
        category: 'Electrolytes',
      },
      {
        id: 'osm',
        name: 'Serum Osmolality',
        abbreviation: 'Osm',
        value: 245,
        unit: 'mOsm/kg',
        referenceRange: { min: 275, max: 295 },
        category: 'Electrolytes',
      },
      {
        id: 'urine-osm',
        name: 'Urine Osmolality',
        abbreviation: 'U-Osm',
        value: 520,
        unit: 'mOsm/kg',
        referenceRange: { min: 50, max: 1200 },
        category: 'Urine Studies',
      },
    ],
    questions: [
      {
        id: 'q1',
        question: 'What is the most likely diagnosis?',
        type: 'mcq',
        options: [
          'Hypovolemic hyponatremia from surgical blood loss',
          'SIADH (euvolemic hyponatremia)',
          'Hypervolemic hyponatremia from heart failure',
          'Psychogenic polydipsia',
        ],
        correctAnswer: 1,
        explanation:
          'The patient has euvolemic hyponatremia with inappropriately concentrated urine (urine osm > 100) despite low serum osmolality. This is classic for SIADH, which is common post-operatively due to pain, stress, and medications.',
      },
      {
        id: 'q2',
        question: 'What is the appropriate initial management?',
        type: 'mcq',
        options: [
          'Rapid correction with 3% hypertonic saline to prevent cerebral edema',
          'Normal saline infusion',
          'Fluid restriction to 800-1000 mL/day',
          'Immediate hemodialysis',
        ],
        correctAnswer: 2,
        explanation:
          'For euvolemic hyponatremia (SIADH) without severe neurologic symptoms, fluid restriction is first-line therapy. While the Na⁺ is critically low (118), the patient has mild symptoms. Correction should be gradual (6-8 mEq/L in 24 hours) to prevent osmotic demyelination.',
      },
    ],
    diagnosis: 'SIADH (Syndrome of Inappropriate Antidiuretic Hormone secretion)',
    reasoning:
      'This case demonstrates euvolemic hyponatremia in the post-operative setting. Key diagnostic features: (1) low serum sodium and osmolality, (2) inappropriately concentrated urine (Uosm > 100 when Sosm is low), (3) clinical euvolemia, (4) recent surgery. SIADH is common post-operatively due to pain, nausea, medications (opioids), and stress. The D5W infusion contributed by providing free water without adequate sodium.',
    learningPoints: [
      'SIADH is a diagnosis of exclusion requiring euvolemia assessment',
      'Urine osmolality > 100 mOsm/kg with low serum osmolality suggests SIADH',
      'Post-operative state is a common trigger for SIADH',
      'Avoid rapid overcorrection (max 6-8 mEq/L per 24 hours) to prevent osmotic demyelination syndrome',
      'Fluid restriction is first-line therapy for mild-moderate SIADH',
    ],
    mustNotMiss: true,
  },
  {
    id: 'dka-case',
    moduleId: 'acid-base',
    title: 'Diabetic Ketoacidosis',
    difficulty: 'intermediate',
    presentation:
      'A 24-year-old woman with type 1 diabetes presents with 2 days of nausea, vomiting, and abdominal pain. She admits to not taking insulin for the past 3 days. On exam: tachycardic, Kussmaul respirations, fruity breath odor.',
    labValues: [
      {
        id: 'ph',
        name: 'Arterial pH',
        abbreviation: 'pH',
        value: 7.12,
        unit: '',
        referenceRange: { min: 7.35, max: 7.45, criticalLow: 7.0, criticalHigh: 7.7 },
        category: 'Blood Gas',
      },
      {
        id: 'paco2',
        name: 'PaCO₂',
        abbreviation: 'PaCO₂',
        value: 22,
        unit: 'mmHg',
        referenceRange: { min: 35, max: 45 },
        category: 'Blood Gas',
      },
      {
        id: 'hco3',
        name: 'Bicarbonate',
        abbreviation: 'HCO₃⁻',
        value: 8,
        unit: 'mEq/L',
        referenceRange: { min: 22, max: 28 },
        category: 'Electrolytes',
      },
      {
        id: 'na',
        name: 'Sodium',
        abbreviation: 'Na⁺',
        value: 132,
        unit: 'mEq/L',
        referenceRange: { min: 135, max: 145 },
        category: 'Electrolytes',
      },
      {
        id: 'cl',
        name: 'Chloride',
        abbreviation: 'Cl⁻',
        value: 98,
        unit: 'mEq/L',
        referenceRange: { min: 96, max: 106 },
        category: 'Electrolytes',
      },
      {
        id: 'glucose',
        name: 'Glucose',
        abbreviation: 'Glu',
        value: 520,
        unit: 'mg/dL',
        referenceRange: { min: 70, max: 100, criticalHigh: 500 },
        category: 'Metabolic',
      },
      {
        id: 'k',
        name: 'Potassium',
        abbreviation: 'K⁺',
        value: 5.2,
        unit: 'mEq/L',
        referenceRange: { min: 3.5, max: 5.0 },
        category: 'Electrolytes',
      },
      {
        id: 'ketones',
        name: 'Serum Ketones',
        abbreviation: 'Ketones',
        value: 6.5,
        unit: 'mmol/L',
        referenceRange: { min: 0, max: 0.5 },
        category: 'Metabolic',
      },
    ],
    questions: [
      {
        id: 'q1',
        question: 'Calculate the anion gap.',
        type: 'interpretation',
        correctAnswer: '26',
        explanation:
          'Anion Gap = Na⁺ - (Cl⁻ + HCO₃⁻) = 132 - (98 + 8) = 26 mEq/L. This is a significantly elevated anion gap (normal 8-12), indicating the presence of unmeasured anions (ketoacids in this case).',
      },
      {
        id: 'q2',
        question: 'Is the respiratory compensation appropriate for the metabolic acidosis?',
        type: 'mcq',
        options: [
          'Yes, compensation is appropriate',
          'No, there is concurrent respiratory acidosis',
          'No, there is concurrent respiratory alkalosis',
          'Cannot determine from given data',
        ],
        correctAnswer: 0,
        explanation:
          'Use Winter\'s formula to check compensation: Expected PaCO₂ = 1.5 × [HCO₃⁻] + 8 (±2) = 1.5 × 8 + 8 = 20 mmHg (range 18-22). The measured PaCO₂ of 22 mmHg is within expected range, indicating appropriate respiratory compensation.',
      },
    ],
    diagnosis: 'Diabetic Ketoacidosis (DKA)',
    reasoning:
      'Classic DKA triad: hyperglycemia, high anion gap metabolic acidosis, and ketonemia. The patient has severe acidemia (pH 7.12) with markedly elevated anion gap (26) due to accumulation of ketoacids (beta-hydroxybutyrate and acetoacetate). Respiratory compensation is appropriate (Kussmaul respirations lowering PaCO₂). The slightly low sodium is expected due to hyperglycemia causing osmotic shift of water from ICF to ECF. Potassium appears normal but total body potassium is depleted—levels will drop with insulin therapy and must be monitored.',
    learningPoints: [
      'DKA presents with high anion gap metabolic acidosis, hyperglycemia, and ketones',
      'Winter\'s formula assesses appropriate respiratory compensation',
      'Serum potassium may appear normal/high initially due to acidosis and insulin deficiency',
      'Total body potassium is depleted; aggressive replacement needed during treatment',
      'Corrected sodium = measured Na⁺ + 1.6 × [(glucose - 100) / 100]',
      'MUST NOT MISS: DKA is a medical emergency requiring insulin, fluids, and electrolyte management',
    ],
    mustNotMiss: true,
  },
  {
    id: 'aki-case',
    moduleId: 'renal',
    title: 'Acute Kidney Injury Post-Surgery',
    difficulty: 'intermediate',
    presentation:
      'A 72-year-old man with hypertension underwent elective hip replacement 3 days ago. He has been receiving NSAIDs for pain control. Now reports decreased urine output. Blood pressure 95/60 mmHg, pulse 110 bpm. He appears volume depleted.',
    labValues: [
      {
        id: 'cr',
        name: 'Creatinine',
        abbreviation: 'Cr',
        value: 3.2,
        unit: 'mg/dL',
        referenceRange: { min: 0.7, max: 1.3 },
        category: 'Renal',
        description: 'Baseline was 1.1 mg/dL',
      },
      {
        id: 'bun',
        name: 'Blood Urea Nitrogen',
        abbreviation: 'BUN',
        value: 68,
        unit: 'mg/dL',
        referenceRange: { min: 7, max: 20 },
        category: 'Renal',
      },
      {
        id: 'na',
        name: 'Sodium',
        abbreviation: 'Na⁺',
        value: 138,
        unit: 'mEq/L',
        referenceRange: { min: 135, max: 145 },
        category: 'Electrolytes',
      },
      {
        id: 'k',
        name: 'Potassium',
        abbreviation: 'K⁺',
        value: 5.6,
        unit: 'mEq/L',
        referenceRange: { min: 3.5, max: 5.0 },
        category: 'Electrolytes',
      },
      {
        id: 'una',
        name: 'Urine Sodium',
        abbreviation: 'UNa',
        value: 12,
        unit: 'mEq/L',
        referenceRange: { min: 40, max: 220 },
        category: 'Urine Studies',
      },
      {
        id: 'ucr',
        name: 'Urine Creatinine',
        abbreviation: 'UCr',
        value: 120,
        unit: 'mg/dL',
        referenceRange: { min: 20, max: 320 },
        category: 'Urine Studies',
      },
    ],
    questions: [
      {
        id: 'q1',
        question: 'Calculate the BUN:Cr ratio. What does it suggest?',
        type: 'interpretation',
        correctAnswer: '21',
        explanation:
          'BUN:Cr = 68 / 3.2 = 21.25. A ratio > 20:1 suggests prerenal azotemia. In prerenal states, BUN is reabsorbed more avidly than creatinine, leading to disproportionate elevation.',
      },
      {
        id: 'q2',
        question: 'What is the fractional excretion of sodium (FENa)?',
        type: 'mcq',
        options: [
          '< 1% (suggests prerenal AKI)',
          '1-2% (indeterminate)',
          '> 2% (suggests intrinsic AKI)',
          'Cannot calculate from given data',
        ],
        correctAnswer: 0,
        explanation:
          'FENa = [(UNa × SCr) / (SNa × UCr)] × 100 = [(12 × 3.2) / (138 × 120)] × 100 = 0.23%. FENa < 1% strongly suggests prerenal azotemia (volume depletion). The kidney is appropriately retaining sodium.',
      },
    ],
    diagnosis: 'Prerenal Acute Kidney Injury',
    reasoning:
      'This patient has AKI based on acute rise in creatinine (baseline 1.1 → 3.2 mg/dL). Multiple features suggest prerenal etiology: (1) BUN:Cr ratio > 20:1, (2) FENa < 1%, (3) low urine sodium < 20, (4) clinical volume depletion (hypotension, tachycardia, low UOP), (5) recent surgery with likely inadequate fluid resuscitation, (6) NSAID use causing renal vasoconstriction. NSAIDs inhibit prostaglandin synthesis, reducing afferent arteriolar dilation and impairing renal autoregulation, especially in hypovolemic states.',
    learningPoints: [
      'Prerenal AKI is the most common cause of AKI (55-60% of cases)',
      'BUN:Cr > 20:1 suggests prerenal azotemia (BUN reabsorbed more than Cr)',
      'FENa < 1% indicates intact tubular function with avid sodium reabsorption',
      'Urine sodium < 20 mEq/L supports prerenal state',
      'NSAIDs impair renal autoregulation and increase AKI risk in volume-depleted states',
      'Prerenal AKI is reversible with volume resuscitation if caught early',
    ],
    mustNotMiss: false,
  },
  {
    id: 'hepatitis-case',
    moduleId: 'hepatic',
    title: 'Acute Viral Hepatitis',
    difficulty: 'beginner',
    presentation:
      'A 28-year-old woman presents with 1 week of fatigue, nausea, dark urine, and jaundice. She denies alcohol use or acetaminophen overdose. No recent travel. Physical exam shows scleral icterus and mild hepatomegaly.',
    labValues: [
      {
        id: 'alt',
        name: 'Alanine Aminotransferase',
        abbreviation: 'ALT',
        value: 1450,
        unit: 'U/L',
        referenceRange: { min: 7, max: 56 },
        category: 'Hepatic',
      },
      {
        id: 'ast',
        name: 'Aspartate Aminotransferase',
        abbreviation: 'AST',
        value: 1280,
        unit: 'U/L',
        referenceRange: { min: 10, max: 40 },
        category: 'Hepatic',
      },
      {
        id: 'alp',
        name: 'Alkaline Phosphatase',
        abbreviation: 'ALP',
        value: 142,
        unit: 'U/L',
        referenceRange: { min: 44, max: 147 },
        category: 'Hepatic',
      },
      {
        id: 'tbili',
        name: 'Total Bilirubin',
        abbreviation: 'TBili',
        value: 8.2,
        unit: 'mg/dL',
        referenceRange: { min: 0.1, max: 1.2 },
        category: 'Hepatic',
      },
      {
        id: 'dbili',
        name: 'Direct Bilirubin',
        abbreviation: 'DBili',
        value: 5.8,
        unit: 'mg/dL',
        referenceRange: { min: 0.0, max: 0.3 },
        category: 'Hepatic',
      },
      {
        id: 'albumin',
        name: 'Albumin',
        abbreviation: 'Alb',
        value: 3.8,
        unit: 'g/dL',
        referenceRange: { min: 3.5, max: 5.0 },
        category: 'Hepatic',
      },
      {
        id: 'inr',
        name: 'INR',
        abbreviation: 'INR',
        value: 1.2,
        unit: '',
        referenceRange: { min: 0.8, max: 1.1 },
        category: 'Coagulation',
      },
    ],
    questions: [
      {
        id: 'q1',
        question: 'What pattern of liver injury is this?',
        type: 'mcq',
        options: [
          'Hepatocellular injury',
          'Cholestatic injury',
          'Mixed pattern',
          'Normal liver tests',
        ],
        correctAnswer: 0,
        explanation:
          'This is a hepatocellular pattern. The key features are: (1) Marked elevation of ALT and AST (> 1000 U/L), (2) ALT > AST (typical in viral/toxic hepatitis), (3) Relatively normal ALP, (4) R value = (ALT/ULN) / (ALP/ULN) = (1450/56) / (142/147) ≈ 27, which is > 5 indicating hepatocellular pattern.',
      },
      {
        id: 'q2',
        question: 'Which lab value indicates preserved hepatic synthetic function?',
        type: 'mcq',
        options: [
          'Normal albumin (3.8 g/dL)',
          'Minimally elevated INR (1.2)',
          'Elevated total bilirubin',
          'Elevated aminotransferases',
        ],
        correctAnswer: 1,
        explanation:
          'INR reflects hepatic synthesis of clotting factors (II, VII, IX, X). A near-normal INR (1.2) indicates preserved synthetic function, which is reassuring in acute hepatitis. Albumin has a long half-life (20 days) and remains normal in acute injury. Elevated INR would suggest acute liver failure or chronic disease.',
      },
    ],
    diagnosis: 'Acute Hepatocellular Injury (likely Acute Viral Hepatitis)',
    reasoning:
      'This patient presents with classic acute hepatitis: jaundice, dark urine (conjugated bilirubinuria), and malaise. The lab pattern shows severe hepatocellular injury with markedly elevated aminotransferases (ALT 1450, AST 1280). ALT > AST suggests viral or toxic etiology rather than alcoholic hepatitis (where AST:ALT > 2:1). The conjugated (direct) hyperbilirubinemia (5.8 mg/dL) causes visible jaundice. Preserved synthetic function (near-normal INR, normal albumin) indicates this is acute rather than chronic liver disease. The normal ALP rules out cholestatic obstruction. Next steps would include viral serologies (HAV IgM, HBsAg, anti-HCV) to identify the specific viral etiology.',
    learningPoints: [
      'Hepatocellular pattern: ALT/AST >> ALP (R value > 5)',
      'ALT > AST typical in viral/toxic hepatitis; AST > ALT (especially AST:ALT > 2) suggests alcohol',
      'Aminotransferases > 1000 U/L suggest acute viral hepatitis, toxin (acetaminophen), or ischemia',
      'Conjugated (direct) hyperbilirubinemia causes dark urine and visible jaundice',
      'INR is the best marker of synthetic function in acute liver injury',
      'Albumin reflects chronic synthetic dysfunction (long half-life)',
    ],
    mustNotMiss: false,
  },
  {
    id: 'hypothyroid-case',
    moduleId: 'endocrine',
    title: 'Primary Hypothyroidism',
    difficulty: 'beginner',
    presentation:
      'A 45-year-old woman complains of 6 months of fatigue, weight gain (15 lbs), cold intolerance, and constipation. On exam: bradycardia (58 bpm), dry skin, delayed deep tendon reflexes. No goiter palpable.',
    labValues: [
      {
        id: 'tsh',
        name: 'Thyroid Stimulating Hormone',
        abbreviation: 'TSH',
        value: 42.5,
        unit: 'mIU/L',
        referenceRange: { min: 0.4, max: 4.0, criticalHigh: 10.0 },
        category: 'Endocrine',
      },
      {
        id: 'ft4',
        name: 'Free T4',
        abbreviation: 'Free T4',
        value: 0.3,
        unit: 'ng/dL',
        referenceRange: { min: 0.8, max: 1.8 },
        category: 'Endocrine',
      },
      {
        id: 'na',
        name: 'Sodium',
        abbreviation: 'Na⁺',
        value: 132,
        unit: 'mEq/L',
        referenceRange: { min: 135, max: 145 },
        category: 'Electrolytes',
      },
      {
        id: 'cholesterol',
        name: 'Total Cholesterol',
        abbreviation: 'Chol',
        value: 285,
        unit: 'mg/dL',
        referenceRange: { min: 125, max: 200 },
        category: 'Lipids',
      },
      {
        id: 'ck',
        name: 'Creatine Kinase',
        abbreviation: 'CK',
        value: 420,
        unit: 'U/L',
        referenceRange: { min: 30, max: 200 },
        category: 'Muscle',
      },
    ],
    questions: [
      {
        id: 'q1',
        question: 'What type of thyroid disorder is this?',
        type: 'mcq',
        options: [
          'Primary hypothyroidism',
          'Secondary (central) hypothyroidism',
          'Subclinical hypothyroidism',
          'Euthyroid sick syndrome',
        ],
        correctAnswer: 0,
        explanation:
          'This is primary hypothyroidism. The TSH is markedly elevated (42.5) while free T4 is low (0.3). In primary hypothyroidism, the thyroid gland fails, so T4 is low and the pituitary appropriately increases TSH to try to stimulate the thyroid. The inverse log-linear relationship means even small drops in T4 cause large TSH elevations.',
      },
      {
        id: 'q2',
        question: 'Which lab abnormality is commonly associated with hypothyroidism?',
        type: 'mcq',
        options: [
          'Hyponatremia',
          'Hypercholesterolemia',
          'Elevated CK',
          'All of the above',
        ],
        correctAnswer: 3,
        explanation:
          'All three are commonly seen in hypothyroidism. (1) Hyponatremia from impaired free water excretion, (2) Hypercholesterolemia from reduced LDL receptor expression and clearance, (3) Elevated CK from muscle involvement (hypothyroid myopathy). These abnormalities often improve with thyroid hormone replacement.',
      },
    ],
    diagnosis: 'Primary Hypothyroidism',
    reasoning:
      'Classic presentation of hypothyroidism with symptoms of low metabolic rate: fatigue, weight gain, cold intolerance, constipation, bradycardia. Physical exam findings (dry skin, delayed reflexes) support the diagnosis. Lab confirmation shows markedly elevated TSH (42.5) with low free T4 (0.3), diagnostic of primary hypothyroidism. The high TSH indicates the problem is at the thyroid gland level (primary), not the pituitary (secondary would have low TSH and low T4). Associated findings include mild hyponatremia, hypercholesterolemia, and elevated CK—all common in hypothyroidism. Most common cause in iodine-sufficient areas is Hashimoto thyroiditis (autoimmune). Treatment is levothyroxine replacement with goal TSH 0.4-4.0 mIU/L.',
    learningPoints: [
      'TSH is the most sensitive test for primary thyroid dysfunction',
      'Primary hypothyroidism: High TSH, Low T4 (thyroid gland failure)',
      'Secondary hypothyroidism: Low TSH, Low T4 (pituitary failure)',
      'Subclinical hypothyroidism: High TSH, Normal T4 (consider treating if TSH > 10)',
      'Common metabolic effects: hyponatremia, hyperlipidemia, elevated CK',
      'Treat with levothyroxine; monitor TSH in 6-8 weeks',
    ],
    mustNotMiss: false,
  },
];
